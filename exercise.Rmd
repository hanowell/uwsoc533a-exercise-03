---
title: "Exercise 2"
author: '[Your first name] [Your last name]'
date: "`r Sys.Date()`"
output: html_document
---

## Setup

**Install the packages you'll need for this assignment if you haven't already.**

```{r setup}
# Install pacman
if (!require("pacman")) install.packages("pacman")
# p_load function loads packages if installed, or install then loads otherwise
pacman::p_load(dplyr, knitr, kableExtra, readr)
```

**Replace the bracketed placeholders for the `Author` in the YAML header with your actual first and last name.**

## Instructions

**Each question contains instructions in bold, as you see here. Your responses should be in plain text, as below:**

Hey! Don't put your answers in bold text, please! Thanks!

**There are code blocks like the one below, which you will be instructed to fill in with code to calculate the quantities necessary to answer the question.**

```{r}
# Example code block
```

**Your code should store numerical or tabular answers as objects (e.g., a scalar, a vector, a table) in your environment. Below is an example.**

```{r}
my_calculation <- (4000 - 2000) / log(4000/2000)
my_answer <- round(my_calculation, 0)
```

**Often, you will be asked to write your answer down in plain text below your code block. Below is an example of how you might do this that uses the example calculation and answer code above:**

My answer is `r my_answer`.

**In other cases, you will be asked to print the answer in tabular format before commenting on the results. For example**

```{r}
my_df <- data.frame(x = letters[1:3], y = 1:3, z = (1:3)^2)
knitr::kable(my_df) %>%
  kableExtra::column_spec(2:3, border_left = TRUE)
```

**Commentary below:**

Looks like $z = y^2$.

**Notice that the above answer uses MathJax to render math notation from $\LaTeX$. You may find it useful to write MathJax notation in-line by enclosing $\LaTeX$ in single dollar-sign symbols. Other times, you may want to center an equation with double dollar-sign symbols, as below:**

$$
z = y^2
$$

**Lastly, if you'd like to read a prettily-formatted version of these instructions, open up the `exercise.html` file in the exercise folder.**

## Question set 1: Age-standardized crude death rates

### Data collection

**For this section, we'll use the age-specific mortality rate schedule and population structure of high-income and low-income countries, respectively, for the period between 2015 and 2020. The data comes from World Population Prospects 2019 reported by the United Nations Population Division. The income designations are based on World Bank income groups.**

**The original data sources are here:** https://population.un.org/wpp/Download/Standard/Mortality/

**The data has one row per income level and age group (with the same age groups represented for each income level), and three columns:**

1. `income_level %in% c("Low-income countries", "High-income countries)`**: The World Bank income level for which the life table was calculated**
1. `x`**: The exact age at the beginning of the age interval**
1. `mx`**: The age-specific mortality rate for age interval** [`x`, `x + n`)
1. `cx`**: The average proportion of population between ages** [`x`, `x + n`) **over the five-year period**

```{r asmr_by_income, warning=FALSE, message=FALSE}
asmr_by_income <- readRDS("data/unpp19.rds") %>%
  dplyr::filter(
    location %in% c("Low-income countries", "High-income countries"),
    period == "2015-2020"
  ) %>%
  dplyr::rename(income_level = location) %>%
  dplyr::mutate(cx = Lx / Tx[x==0]) %>%
  dplyr::select(income_level, x, n, mx, cx)
```

### Calculate the crude death rate (CDR) by income level

**Using only the age-specific mortality rates `mx` and age structure** `cx`**, compute the CDR by income level and report it below as a table with the following structure:**

* `income_level`: The income level
* `cdr`: The CDR

```{r}

```

**Report the difference between the low-income and high-income CDRs below in a full sentence and comment on the finding in another sentence.**



### Calculate the age-standardized CDR by income level

**Compute the age-standardized CDR by income level using three standards:**

1. **High-income countries standard**
1. **Low-income contries standard**
1. **Standard constructed from the average of high-income and low-income countries**

**Report the results in a table below with the following structure:**

1. `income_level`**: The income level**
1. `cdr_[high/low/avg]`**: three columns, one for each of the standards indicated above and in the placeholder brackets (e.g.,** `cdr_high`**)**

**Comment on the results in a brief paragraph below. If you like, create plots or tables referencing the components of the original dataset to help explain the results. But words can suffice.**



## Question set 2: Channel-standardized customer conversion rates

### Data collection

### Calculate the crude customer conversion rate for each website

### Calculate the age-standardized crude customer conversion rate using the main website as a standard
